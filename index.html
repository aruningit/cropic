// Function to get image size
function getImageSize(imagePath) {
  return new Promise((resolve, reject) => {
    const img = new Image();
    img.onload = function () {
      const width = img.width;
      const height = img.height;
      resolve({ width, height });
    };
    img.onerror = function () {
      reject(new Error('Failed to load image'));
    };
    img.src = imagePath;
  });
}

// Function to get image pixels
function getImagePixels(imagePath) {
  return new Promise((resolve, reject) => {
    const img = new Image();
    img.onload = function () {
      const canvas = document.createElement('canvas');
      canvas.width = img.width;
      canvas.height = img.height;
      const context = canvas.getContext('2d');
      context.drawImage(img, 0, 0);
      const imageData = context.getImageData(0, 0, img.width, img.height);
      resolve({ width: img.width, height: img.height, pixels: imageData.data });
    };
    img.onerror = function () {
      reject(new Error('Failed to load image'));
    };
    img.src = imagePath;
  });
}

// Function to convert image format
function convertImageFormat(imagePath, outputFormat, outputQuality = 0.92) {
  return new Promise((resolve, reject) => {
    const img = new Image();
    img.onload = function () {
      const canvas = document.createElement('canvas');
      canvas.width = img.width;
      canvas.height = img.height;
      const context = canvas.getContext('2d');
      context.drawImage(img, 0, 0);
      const newDataURL = canvas.toDataURL(`image/${outputFormat}`, outputQuality);
      resolve(newDataURL);
    };
    img.onerror = function () {
      reject(new Error('Failed to load image'));
    };
    img.src = imagePath;
  });
}

// Example usage

// Get image size
getImageSize('example.jpg')
  .then(({ width, height }) => {
    console.log(`Image size: ${width} x ${height}`);
  })
  .catch((error) => {
    console.error(error);
  });

// Get image pixels
getImagePixels('example.jpg')
  .then(({ width, height, pixels }) => {
    console.log(`Image size: ${width} x ${height}`);
    console.log(`Pixel at (0, 0): [${pixels[0]}, ${pixels[1]}, ${pixels[2]}, ${pixels[3]}]`);
  })
  .catch((error) => {
    console.error(error);
  });

// Convert image format
convertImageFormat('example.jpg', 'png')
  .then((newDataURL) => {
    console.log('Image converted successfully!');
    console.log('New image data URL:', newDataURL);
  })
  .catch((error) => {
    console.error(error);
  });
